- include a js file
- startOauth, endOAuth, and syncFrame in /unhosted dir
- new functions:
   connect(userAddress, categories, cb)//storageInfo, bearerToken
   client.sync(onreadystatechange)

<!DOCTYPE html>
  <head>
    <script src="http://unhosted.org/require.js"></script>
    <script>
      function getStatus () {
        if(localStorage.storageInfo) {
          if(localStorage.bearerToken) {
            return('ready');
          } else {
            return('allow');
          }
        } else {
          return('signin');
        }
      }
      function onload () {
        var status = getStatus()
            document.getElementById('allowDiv').style.display='block';
          document.getElementById('goDiv').style.display='block';
      require(['http://unhosted.org/remoteStorage-0.4.3.js'], function(remoteStorage) {
        document.getElementById('go').onclick = function() {
          document.getElementById('goDiv').style.display='none';
          document.getElementById('status').innerHTML='checking...';
          remoteStorage.getStorageInfo(document.getElementById('userAddress').value, function(err, storageInfo) {
            document.getElementById('status').innerHTML='';
            document.getElementById('allowDiv').style.display='block';
            localStorage.storageInfo=JSON.stringify(storageInfo);
          });
        }
        document.getElementById('allow').onclick = function() {
          var category = 'sandwiches';
          var storageInfo = JSON.parse(localStorage.storageInfo);
          var categories = [category];
          var redirectUri=location.protocol+'//'+location.host+'/rcvToken.html';
          //window.open(redirectUri+'#access_token=abc');
          window.open(remoteStorage.createOAuthAddress(storageInfo, categories, redirectUri));
          window.addEventListener('message', function(event) {
            if(event.origin == location.protocol +'//'+ location.host) {
              localStorage.bearerToken = event.data;
              document.getElementById('allowDiv').style.display='none';
              //document.getElementById('status').innerHTML='syncing...';
              start();
            }
          }, false);
        }
        document.getElementById('logout').onclick = function() {
          localStorage.clear();
          document.getElementById('syncer').src='';
          document.getElementById('logoutDiv').style.display='none';
          document.getElementById('goDiv').style.display='block';
        }
      });
      function start() {
        var storageInfo = JSON.parse(localStorage.storageInfo);
        document.getElementById("syncer").src='/sync.html?category=sandwiches'
          +'&api='+storageInfo.api
          +'&template='+storageInfo.template
          +'&token='+localStorage.bearerToken;
        document.getElementById('logoutDiv').style.display='block';
      }
      window.addEventListener('storage', function(e) {
        if(e.key == 'favSandwich') {
          document.getElementById('favSandwich').value = e.newValue;
        };
      }, false);
    </script>
  </head>
  <body onload="onload();">
    <div id="logoutDiv" style="display:none;">
      <input type="submit" value="logout" id="logout">
    </div>
    <div id="goDiv" style="display:none;">
      <input id="userAddress" placeholder="user@host">
      <input type="submit" value="sync" id="go">
    </div>
    <div id="allowDiv" style="display:none;">
      <input type="submit" value="allow" id="allow">
    </div>
    <div id="status"></div>
    <iframe id="syncer" style="border-style: none;"></iframe>
    My Favourite Sandwich has
      <input id="favSandwich" onkeyup="localStorage.favSandwich = this.value;">
    on it.
  </body>
</html>
